(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{417:function(_,a,n){"use strict";n.r(a);var i=n(39),e=Object(i.a)({},function(){var _=this,a=_.$createElement,n=_._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":_.$parent.slotKey}},[n("p",[_._v("看到各位神仙已经写的够详细了，我也来写写我的见解吧。")]),_._v(" "),n("h1",{attrs:{id:"多项式"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#多项式","aria-hidden":"true"}},[_._v("#")]),_._v(" 多项式")]),_._v(" "),n("h2",{attrs:{id:"多项式是什么"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#多项式是什么","aria-hidden":"true"}},[_._v("#")]),_._v(" 多项式是什么")]),_._v(" "),n("p",[_._v("关于多项式，我们已经在小学一年级的时候已经认识了，所以就不多说了。")]),_._v(" "),n("h2",{attrs:{id:"多项式的表示方法"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#多项式的表示方法","aria-hidden":"true"}},[_._v("#")]),_._v(" 多项式的表示方法")]),_._v(" "),n("h3",{attrs:{id:"多项式的系数表示法"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#多项式的系数表示法","aria-hidden":"true"}},[_._v("#")]),_._v(" 多项式的系数表示法")]),_._v(" "),n("p",[_._v("设 $f_i$ 表示 $n$ 次多项式$F(x)$ $i$ 次项的系数，则")]),_._v(" "),n("p",[_._v("$$F(x)=\\sum_{i=0}^nf_ix^i$$")]),_._v(" "),n("h3",{attrs:{id:"点值表示法"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#点值表示法","aria-hidden":"true"}},[_._v("#")]),_._v(" 点值表示法")]),_._v(" "),n("p",[_._v("我们在小学二年级的时候学过，一个 $n$ 次多项式 $F(x)$ 可以由 $n+1$ 个不同的点 $(x_i,F(x_i))$ 确定。如果不明白的话没关系，这不重要。")]),_._v(" "),n("h1",{attrs:{id:"多项式的乘法"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#多项式的乘法","aria-hidden":"true"}},[_._v("#")]),_._v(" 多项式的乘法")]),_._v(" "),n("p",[_._v("关于多项式的乘法，我们已经在小学二年级学过了。我也就不多说了。")]),_._v(" "),n("p",[_._v("很明显，系数表示法下朴素算法的时间复杂度是 $\\Theta(nm)$，会被卡。")]),_._v(" "),n("p",[_._v("那点值表示法呢？看上去只要每个点和对应的点乘一乘就好了，复杂度 $\\Theta(nm)$，但从系数表示法转换成点值表示法是 $\\Theta(nm)$ 的。")]),_._v(" "),n("p",[_._v("怎么优化呢？这就用到我们的 $\\text{FFT}&\\text{NTT}$了。")]),_._v(" "),n("h1",{attrs:{id:"fft"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#fft","aria-hidden":"true"}},[_._v("#")]),_._v(" FFT")]),_._v(" "),n("p",[_._v("在学习 FFT 之前，我们先来复习一下我们小学三年级学的"),n("strong",[_._v("复数")]),_._v("和"),n("strong",[_._v("单位根")])]),_._v(" "),n("h2",{attrs:{id:"复数"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#复数","aria-hidden":"true"}},[_._v("#")]),_._v(" 复数")]),_._v(" "),n("h3",{attrs:{id:"复数的概念"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#复数的概念","aria-hidden":"true"}},[_._v("#")]),_._v(" 复数的概念")]),_._v(" "),n("blockquote",[n("p",[_._v("我们把形如 $z=a+bi$（$a,b$ 均为实数）的数称为"),n("code",[_._v("复数")]),_._v("，其中 $a$ 称为实部，$b$ 称为"),n("code",[_._v("虚部")]),_._v("，$i$ 称为"),n("code",[_._v("虚数单位")]),_._v("。 ——百度百科")])]),_._v(" "),n("p",[_._v("我觉得这已经讲得够详细了，我就不补充了。")]),_._v(" "),n("h3",{attrs:{id:"复数的运算"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#复数的运算","aria-hidden":"true"}},[_._v("#")]),_._v(" 复数的运算")]),_._v(" "),n("ul",[n("li",[_._v("复数的加法：$(a+bi)+(c+di)=(a+c)+(b+d)i$")]),_._v(" "),n("li",[_._v("复数的减法：同理")]),_._v(" "),n("li",[_._v("复数的乘法：$(a+bi)(c+di)=ac+adi+bci-bd=(ac-bd)+(ad+bc)i$")])]),_._v(" "),n("p",[_._v("此外，复数相乘在极坐标中的几何意义是："),n("strong",[_._v("模长相乘，幅角相加")]),_._v("。")]),_._v(" "),n("h2",{attrs:{id:"单位根"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#单位根","aria-hidden":"true"}},[_._v("#")]),_._v(" 单位根")]),_._v(" "),n("h3",{attrs:{id:"单位根的定义"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#单位根的定义","aria-hidden":"true"}},[_._v("#")]),_._v(" 单位根的定义")]),_._v(" "),n("blockquote",[n("p",[_._v("数学上，$n$ 次单位根是 $n$ 次幂为 $1$ 的复数。它们位于复平面的单位圆上，构成正 $n$ 边形的顶点，其中一个顶点是 $1$。$n$次单位根的模为 $1$  ——百度百科")])]),_._v(" "),n("p",[_._v("$n$ 次单位根共有 $n$ 个，它们是：")]),_._v(" "),n("p",[_._v("$$\\cos\\frac{2k\\pi}{n}+i\\sin\\frac{2k\\pi}{n}$$")]),_._v(" "),n("p",[_._v("其中 $k$ 是整数且 $1\\leq k \\leq n$。")]),_._v(" "),n("p",[_._v("配合图片理解（$n=8$ 的情况）：")]),_._v(" "),n("p",[n("img",{attrs:{src:"https://i.loli.net/2020/02/21/l2tg6HQANhu8ydq.png",alt:""}})]),_._v(" "),n("p",[_._v("我们把 $\\cos\\frac{2\\pi}{n}+i\\sin\\frac{2\\pi}{n}$ 记为 $\\omega_n$（如图中的 $D$表示的复数，我们就把它记作 $\\omega_8$）。")]),_._v(" "),n("p",[_._v("显然，$\\omega_n^k=\\cos\\frac{2k\\pi}{n}+i\\sin\\frac{2k\\pi}{n}$")]),_._v(" "),n("h3",{attrs:{id:"单位根的性质："}},[n("a",{staticClass:"header-anchor",attrs:{href:"#单位根的性质：","aria-hidden":"true"}},[_._v("#")]),_._v(" 单位根的性质：")]),_._v(" "),n("ol",[n("li",[_._v("$\\omega_n^0=1$"),n("br"),_._v("\n显然。")]),_._v(" "),n("li",[_._v("$\\omega_n^n=1$"),n("br"),_._v("\n证明：$\\omega_n^n=\\omega_n^k=\\cos\\frac{2n\\pi}{n}+i\\sin\\frac{2n\\pi}{n}=\\cos 2\\pi+\\sin 2\\pi=1+0=1$")]),_._v(" "),n("li",[_._v("$\\omega_{2n}^{2k}=\\omega_n^k$"),n("br"),_._v("\n证明：$\\omega_{2n}^{2k}=\\cos\\frac{4k\\pi}{2n}+i\\sin\\frac{4k\\pi}{2n}=\\cos\\frac{2k\\pi}{n}+i\\sin\\frac{2k\\pi}{n}=\\omega_n^k$")]),_._v(" "),n("li",[_._v("$\\omega_{n}^{\\frac{n}{2}}=-1$"),n("br"),_._v("\n证明：$\\omega_{n}^{\\frac{n}{2}}=\\cos\\frac{n\\pi}{n}+i\\sin\\frac{n\\pi}{n}=\\cos\\pi+i\\sin\\pi=-1$")])]),_._v(" "),n("h2",{attrs:{id:"快速傅里叶变换（fft）"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#快速傅里叶变换（fft）","aria-hidden":"true"}},[_._v("#")]),_._v(" 快速傅里叶变换（FFT）")]),_._v(" "),n("p",[_._v("上面讲了一大堆什么单位根，有什么用呢？没错！我们要把它们带入多项式里去。")]),_._v(" "),n("p",[_._v("前面说过，一个 $n$ 次多项式 $F(x)$ 可以由 $n+1$ 个不同的点 $(x_i,F(x_i))$ 确定。"),n("strong",[_._v("我们这里令$n$为 $F(x)$ 的次数 $+1$。")])]),_._v(" "),n("p",[_._v("但显然，仅仅是简单的带入和朴素算法没区别。但利用单位根的性质，我们可以使用"),n("strong",[_._v("分治")]),_._v("进行优化。")]),_._v(" "),n("p",[_._v("不妨把一个多项式 $F(x)$ 按照奇偶性分成两组：")]),_._v(" "),n("p",[_._v("$$\\begin{aligned}F(x)&=f_0x^0+f_1x^1+f_2x^2+\\dots\\&=(f_0x^0+f_2x^2+f_4x^4+\\dots)+(f_1x^1+f_3x^3+f_5x^5+\\dots)\\&=(f_0x^0+f_2x^2+f_4x^4+\\dots)+x(f_1x^0+f_3x^2+f_5x^4+\\dots)\\end{aligned}$$")]),_._v(" "),n("p",[_._v("我们令 $L(x)=f_0x^0+f_2x^1+f_3x^2+\\dots$，$R(x)=f_1x^0+f_3x^1+f_5x^2+\\dots$")]),_._v(" "),n("p",[_._v("显然，$F(x)=L(x^2)+xR(x^2)$。")]),_._v(" "),n("p",[_._v("然后我们带入 $\\omega_n^k$。\n，得到")]),_._v(" "),n("p",[_._v("$$\\begin{aligned}F(\\omega_n^k)&=L(\\omega_n^{2k})+\\omega_n^kR(\\omega_n^{2k})\\&=L(\\omega_\\frac{n}{2}^k)+\\omega_n^kR(\\omega_\\frac{n}{2}^k)\\end{aligned}$$")]),_._v(" "),n("p",[_._v("然后我们发现，$L(x)$ 和 $R(x)$ 的 $x$ 取值范围是 $\\omega_\\frac{n}{2}^0\\sim\\omega_\\frac{n}{2}^{\\frac{n}{2}-1}$，但这里的 $k$ 取值范围是 $0\\sim n-1$，明显超过了。但别忘了，$\\omega_{n}^{\\frac{n}{2}}=-1$。我们把 $\\omega_n^{k+\\frac{n}{2}}$带入。")]),_._v(" "),n("p",[_._v("$$\\begin{aligned}F(\\omega_n^{k+\\frac{n}{2}})&=L(\\omega_n^{2k+n})+\\omega_n^{k+\\frac{n}{2}}R(\\omega_n^{2k+n})\\&=L(\\omega_\\frac{n}{2}^k)-\\omega_n^kR(\\omega_\\frac{n}{2}^k)\\end{aligned}$$")]),_._v(" "),n("p",[_._v("于是我们在计算 $F(\\omega_n^k)$ 的时候同时计算 $F(\\omega_n^{k+\\frac{n}{2}})$。")]),_._v(" "),n("h2",{attrs:{id:"快速傅里叶逆变换"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#快速傅里叶逆变换","aria-hidden":"true"}},[_._v("#")]),_._v(" 快速傅里叶逆变换")]),_._v(" "),n("p",[_._v("转换成点至表示法运算完之后还需要重新转换成系数表示法。")]),_._v(" "),n("p",[_._v("设 $g_i=F(\\omega_n^i)$，$G(x)=\\sum_{i=0}^ng_ix^i$")]),_._v(" "),n("p",[_._v("看似无从下手呢。")]),_._v(" "),n("p",[n("s",[_._v("于是我们可以考虑上网搜题解。")])]),_._v(" "),n("p",[n("s",[_._v("网上的题解显示")]),_._v("先带一个 $\\omega_n^{-k}$ 。"),n("s",[_._v("然后直觉告诉我们这是对的。")])]),_._v(" "),n("p",[_._v("$$\\begin{aligned}G(\\omega_n^{-k})&=\\sum_{i=0}^{n-1}g_i\\omega_n^{-ki}\\&=\\sum_{i=0}^{n-1}(\\sum_{j=0}^{n-1}f_j\\omega_n^{ij})\\omega_n^{-ki}\\&=\\sum_{i=0}^{n-1}\\sum_{j=0}^{n-1}f_j\\omega_n^{ij}\\omega_n^{-ki}\\&=\\sum_{j=0}^{n-1}f_j\\sum_{i=0}^{n-1}\\omega_n^{(j-k)i}\\end{aligned}$$")]),_._v(" "),n("p",[_._v("我们先对 $\\sum_{i=0}\\limits^{n-1}\\omega_n^{(j-k)i}$ 这个式子下手。")]),_._v(" "),n("p",[_._v("分两种情况讨论：")]),_._v(" "),n("ol",[n("li",[_._v("当 $j=k$ 时，显然这个式子的结果是 $n$。")]),_._v(" "),n("li",[_._v("当 $j\\neq k$ 时，我们就用到了我们的等比数列求和大法。先看这个等式：\n$$\\sum_{i=0}^{n-1}\\omega_n^{(j-k)i}=\\sum_{i=0}^{n-1}\\omega_n^{(j-k)i}$$\n它显然成立。我们在这个等式两边同时乘上 $\\omega_n^{j-k}$，得到：\n$$\\omega_n^{j-k}\\sum_{i=0}^{n-1}\\omega_n^{(j-k)i}=\\sum_{i=0}^{n-1}\\omega_n^{(j-k)(i+1)}$$\n两等式相减，得\n$$(\\omega_{n-1}^{j-k}-1)\\sum_{i=0}^{n-1}\\omega_n^{(j-k)i}=1-\\omega_n^{n}$$\n想想单位根的某个性质。\n$$\\begin{aligned}&\\ \\ \\ \\ \\ \\ (\\omega_{n-1}^{j-k}-1)\\sum_{i=0}^{n-1}\\omega_n^{(j-k)i}&=&0\\&\\Rightarrow\\sum_{i=0}^{n-1}\\omega_n^{(j-k)i}&=&0\\end{aligned}$$")])]),_._v(" "),n("p",[_._v("回到原式。我们发现，当 $j=k$ 时，$\\sum_{i=0}\\limits^{n-1}\\omega_n^{(j-k)i}=n$，且这种情况只有一次出现，其余情况 $\\sum_{i=0}\\limits^{n-1}\\omega_n^{(j-k)i}$ 均等于 $0$。")]),_._v(" "),n("p",[_._v("所以，\n$$\\begin{aligned}&\\ \\ \\ \\ \\ \\ G(\\omega_n^{-k})&=&\\sum_{j=0}^{n-1}f_j\\sum_{i=0}^{n-1}\\omega_n^{(j-k)i}\\&&=&nf_k\\&\\Rightarrow f_k&=&\\frac{G(\\omega_n^{-k})}{n}\\end{aligned}$$")]),_._v(" "),n("hr"),_._v(" "),n("p",[_._v("好了，FFT的理论部分就讲到这里。")]),_._v(" "),n("h1",{attrs:{id:"ntt"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ntt","aria-hidden":"true"}},[_._v("#")]),_._v(" NTT")]),_._v(" "),n("h1",{attrs:{id:"铭谢"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#铭谢","aria-hidden":"true"}},[_._v("#")]),_._v(" 铭谢")]),_._v(" "),n("ul",[n("li",[_._v("感谢@attack 神仙的题解。这篇题解和那篇题解的思路是基本一样的，所以会有很多相似的地方。")])])])},[],!1,null,null,null);a.default=e.exports}}]);